from MLEC import Correlations, CorrelationType
import numpy as np
import torch
from MLEC.loss.inter_corr_loss import inter_corr_loss
from MLEC.loss.intra_corr_loss import intra_corr_loss

corr = Correlations(
    col_names=np.array(
        [
            "anger",
            "anticipation",
            "disgust",
            "fear",
            "joy",
            "sadness",
            "surprise",
            "trust",
            "pessimism",
            "optimism",
            "love",
        ]
    ),
    corr_type=CorrelationType.PLUTCHIK,
)

logits = torch.tensor(
    [
        [
            -0.1737,
            -0.3160,
            -0.1099,
            -0.0711,
            -0.2162,
            -0.1618,
            -0.1665,
            -0.1402,
            -0.3219,
            -0.2582,
            -0.1362,
        ],
        [
            -0.0702,
            -0.2890,
            -0.1573,
            -0.0851,
            -0.3026,
            -0.2724,
            -0.2534,
            -0.2156,
            -0.1898,
            -0.3289,
            -0.3276,
        ],
        [
            0.1920,
            -0.1031,
            -0.2191,
            -0.1509,
            -0.2111,
            -0.1339,
            -0.1360,
            -0.2052,
            -0.1535,
            -0.2553,
            -0.3888,
        ],
        [
            0.0012,
            -0.1041,
            -0.0248,
            -0.2451,
            -0.1952,
            -0.2312,
            -0.3033,
            -0.2252,
            -0.0540,
            -0.3390,
            -0.3264,
        ],
        [
            -0.1016,
            -0.1062,
            -0.1527,
            -0.1503,
            -0.2644,
            -0.2247,
            -0.0276,
            -0.1539,
            -0.1151,
            -0.1087,
            -0.0755,
        ],
        [
            -0.0331,
            0.0143,
            0.0079,
            -0.0602,
            -0.1528,
            0.0203,
            0.0692,
            -0.1358,
            -0.0306,
            -0.0452,
            -0.0729,
        ],
        [
            -0.0065,
            -0.1343,
            -0.1010,
            -0.1374,
            -0.1845,
            -0.2036,
            -0.2629,
            -0.2466,
            -0.0837,
            -0.3072,
            -0.3122,
        ],
        [
            0.0509,
            -0.2004,
            -0.2187,
            -0.2234,
            -0.1099,
            -0.1498,
            -0.0878,
            -0.1538,
            -0.1759,
            -0.1856,
            -0.1752,
        ],
        [
            -0.0883,
            0.0076,
            -0.0804,
            -0.1354,
            -0.1416,
            -0.1841,
            -0.1491,
            -0.0524,
            -0.0121,
            -0.2008,
            -0.2255,
        ],
        [
            -0.0101,
            -0.1002,
            -0.2054,
            -0.0330,
            -0.1883,
            -0.1440,
            -0.1157,
            -0.1705,
            -0.0403,
            -0.1738,
            -0.3057,
        ],
        [
            0.0485,
            0.0160,
            -0.0776,
            -0.0135,
            -0.2787,
            -0.1879,
            -0.1520,
            -0.1777,
            -0.0700,
            -0.3096,
            -0.1265,
        ],
        [
            0.1118,
            -0.1954,
            -0.0103,
            -0.1786,
            -0.1632,
            -0.3018,
            -0.0041,
            -0.1456,
            -0.2277,
            -0.0936,
            -0.1807,
        ],
        [
            -0.1925,
            -0.1943,
            -0.1012,
            -0.0467,
            -0.3071,
            -0.1114,
            -0.1999,
            -0.3915,
            -0.0528,
            -0.1952,
            -0.3113,
        ],
        [
            -0.0964,
            -0.0459,
            -0.0411,
            -0.0291,
            -0.1749,
            -0.3610,
            -0.1899,
            -0.2539,
            -0.1409,
            -0.2200,
            -0.1871,
        ],
        [
            -0.1931,
            -0.0780,
            -0.0770,
            -0.0128,
            -0.3877,
            -0.3679,
            -0.1478,
            -0.2479,
            -0.1813,
            -0.3482,
            -0.3397,
        ],
        [
            -0.1351,
            -0.1644,
            0.0456,
            -0.1317,
            -0.2514,
            -0.0898,
            -0.1044,
            -0.1855,
            -0.1212,
            -0.2486,
            -0.2629,
        ],
        [
            -0.1198,
            -0.1821,
            -0.0480,
            -0.0082,
            -0.1485,
            -0.1164,
            -0.1985,
            -0.0282,
            -0.0755,
            -0.1235,
            -0.1781,
        ],
        [
            0.0354,
            -0.0662,
            -0.0575,
            -0.0832,
            -0.2780,
            -0.2436,
            -0.1758,
            -0.1914,
            -0.0450,
            -0.2782,
            -0.2453,
        ],
        [
            -0.0138,
            -0.1414,
            -0.0018,
            -0.0991,
            -0.1603,
            -0.1477,
            -0.1462,
            -0.2301,
            -0.0829,
            -0.2002,
            -0.1340,
        ],
        [
            -0.2598,
            -0.0831,
            -0.2119,
            -0.0913,
            -0.1387,
            -0.1285,
            -0.0620,
            -0.3123,
            0.0810,
            -0.2611,
            -0.1290,
        ],
        [
            0.0233,
            -0.1471,
            -0.1167,
            -0.0717,
            -0.1868,
            -0.3376,
            -0.1978,
            -0.3163,
            0.0414,
            -0.1607,
            -0.1555,
        ],
        [
            -0.2989,
            -0.1897,
            -0.0530,
            0.0082,
            -0.3358,
            -0.0771,
            -0.1457,
            -0.0958,
            -0.0285,
            -0.2644,
            -0.2787,
        ],
        [
            0.0608,
            -0.0983,
            -0.2518,
            -0.0267,
            -0.1825,
            -0.1635,
            -0.2224,
            -0.1469,
            -0.0523,
            -0.2177,
            -0.2063,
        ],
        [
            -0.1867,
            -0.1622,
            -0.1499,
            -0.0009,
            -0.2068,
            -0.0945,
            -0.1223,
            -0.1223,
            -0.0292,
            -0.2549,
            -0.2590,
        ],
        [
            0.1669,
            -0.2390,
            -0.2403,
            -0.0768,
            -0.2058,
            -0.1655,
            -0.1062,
            -0.1930,
            -0.1108,
            -0.0320,
            -0.2201,
        ],
        [
            -0.0088,
            0.0443,
            -0.0608,
            0.0321,
            -0.2883,
            -0.1420,
            -0.1997,
            -0.2624,
            -0.1330,
            -0.2713,
            -0.1346,
        ],
        [
            -0.0174,
            -0.2283,
            -0.0363,
            -0.1204,
            -0.2391,
            -0.1259,
            -0.1517,
            -0.3594,
            -0.0391,
            -0.2462,
            -0.1831,
        ],
        [
            -0.0380,
            -0.0644,
            -0.1173,
            -0.0773,
            -0.2481,
            -0.0496,
            -0.1761,
            -0.2272,
            -0.1449,
            -0.2761,
            -0.1344,
        ],
        [
            -0.0881,
            -0.1701,
            -0.0561,
            -0.1532,
            -0.1612,
            -0.1421,
            -0.0902,
            -0.2618,
            -0.2144,
            -0.1063,
            -0.1113,
        ],
        [
            0.1353,
            -0.0106,
            -0.0923,
            -0.1087,
            -0.1869,
            -0.1431,
            -0.0943,
            -0.2512,
            -0.0110,
            -0.2920,
            -0.2934,
        ],
        [
            -0.1242,
            0.1454,
            -0.1172,
            -0.1267,
            -0.2602,
            -0.1929,
            -0.2260,
            -0.4485,
            -0.1171,
            -0.1996,
            -0.1049,
        ],
        [
            0.0439,
            -0.2803,
            -0.1392,
            -0.2386,
            -0.2741,
            -0.2437,
            -0.0552,
            -0.2322,
            -0.0656,
            -0.2381,
            -0.2465,
        ],
    ]
)
targets = torch.tensor(
    [
        [1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0],
        [1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0],
        [1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0],
        [1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0],
        [0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0],
        [1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0],
        [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0],
        [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0],
        [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0],
        [1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
        [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
        [0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0],
        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0],
        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0],
        [1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
        [0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0],
        [1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0],
        [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0],
        [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0],
        [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
    ]
)

inter_loss = inter_corr_loss(logits, targets, corr)
intra_loss = intra_corr_loss(logits, targets, corr)

print("inter_loss : ", inter_loss)
print("intra_loss : ", intra_loss)
